<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Test</title>
    <style>
      p { clear: both; }
    </style>
    <script src="./audiojs/audio.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script>
      audiojs.events.ready(function() {
        var as = audiojs.createAll();
      });
      
      function debug_out(str){
        console.log( str );
      }

      function add_test()
      {
        var flag = false;
        for(var i=0; i<document.test1.music1.length-1; i++){
          if(document.test1.music1[i].checked){
            flag = true;
          }
        }

          let data = {
            name: "hogeta_hogetarou",
            result: [
                { element: document.getElementById("mus1").value, name: flag },
                { element: document.getElementById("mus2").value, name: "test2" }
            ]
          };

          let output = {
            request: "memory_result",
            number: 1005,
            json: data
          };

        debug_out( JSON.stringify(output));

        $.ajax({
            //url:"/kani/php/get.php", // 通信先のURL
            url:"https://bbled.org/kani/crest_php/add.php", // 通信先のURL
            type:"POST",		// 使用するHTTPメソッド
            data: JSON.stringify(output),
            //data: '{"request": "memory_result", "number":"1000", "json": }', // 送信するデータ
            contentType: 'application/json',
            dataType:"json", // 応答のデータの種類 
                            // (xml/html/script/json/jsonp/text)
            timespan:10000 		// 通信のタイムアウトの設定(ミリ秒)
        }).done(function(data1,textStatus,jqXHR) {
            debug_out(data1);
            debug_out(textStatus); //例：error
            debug_out(jqXHR.status); //例：404
    
        }).fail(function(jqXHR, textStatus, errorThrown ) {
            debug_out(jqXHR.status); //例：404
            debug_out(textStatus); //例：error
            debug_out(errorThrown); //例：NOT FOUND
    
                    // 7. alwaysは、成功/失敗に関わらず実行される
        }).always(function(){
            debug_out("complete test");
          });
      }

    </script>
  </head>
  <body>
      <h1>正しい音源だと思う方にチェックを入れてください</h1>
      <form id="test1">
      <p>音源1<input type="radio" id="mus1" name="music1" value="1-1" required>
      <audio src="./mp3/musictest1-1.mp3" controls></audio></p>
    
      <p>音源2<input type="radio" id="mus2" name="music1" value="1-2">
      <audio src="./mp3/musictest1-2.mp3" controls></audio></p>
      </form>
      <input type="button" onclick="add_test();" value="次へ">
  </body>
</html>
